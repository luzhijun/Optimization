# encoding: utf-8
import cma
import numpy as np
from math import sin, pi, pow
import optproblems.real as opr
import functools
'''
functions
'''
__author__ = "luzhijun"

matrix2D = np.array([[4.4632867438003154e-1, 1.5894632776519158],
                     [-3.9310341311896009, -2.7966708535050393]])

matrix10D = np.array([[-1.1110697888144878, 0.36905789544385453, 0.7292055292144803, -0.42847443920418715, -0.32558066659661755, -1.446565452628495, -0.020224085659255202, 1.5503062159856127, 0.9223087681212796, 1.1404581440230421],
                      [1.5092777909404804, -0.4599298468134994, -0.2455426051220394, -0.5551264613775078, -1.8651997436174714, -
                       0.12195709189112197, -1.9679217757126555, -1.4248750959518428, -0.8155634563877943, 0.22223404831489502],
                      [-0.5640279361008805, 0.5604791845701329, 0.4027307660174637, 0.10593056356204295, -1.8718870129434997, -
                       0.9936668670945775, 1.7677849646336035, 1.6106625259748026, -1.0123369759917022, 0.6077665913774026],
                      [-0.1098180630614653, 0.30970829860712834, -1.3245588099086854, 0.9859399464337323, 0.1355979273645493,
                       0.028150671230047226, 1.001596419139145, 0.08579900652808065, 0.014468896133512495, -1.2914400024570518],
                      [0.8770280237386544, -0.5995510785229491, 0.034166677827547016, 0.4544431333317236, 0.6141138072484364,
                       0.08713506884733818, -0.37193688015275456, 0.30270728793727675, -0.039512527976833356, -0.44801215556282553],
                      [0.6888221374558707, 1.1470043442495683, 0.8632079673083123, -0.47180326822629304, 1.7206295945742422, -
                       0.9192731070464375, -1.2344873056018493, 0.5867874862240999, 0.7112782132904119, 1.0565811136727492],
                      [0.33995500494567416, 0.4419526642630929, 0.682467208794489, 0.1671188992095813, -2.3623524924091583,
                       0.0839137754815431, 0.09556465834393763, 0.012213386723430246, -0.23738972474670303, -0.2753469794049502],
                      [1.190079821855058, -0.667054552031223, 0.8711175453115998, -0.7985618910202718, 0.6944240170910183, -
                       0.7035731837431797, -0.8460840934908737, -1.0734520052438552, -0.6888710861789611, -0.7235422746201137],
                      [-0.15363247693593787, -0.04619078947565181, 1.3335277878980332, -0.10031163853521424, 1.2209115415033431, -
                       1.2275314484176902, 0.057371210992301205, -0.11377154788313812, 0.726923760585939, 1.9524121519232884],
                      [1.357557811598952, -0.04304128471937102, 0.7151477814755193, -1.4644509947508315, -2.023762074738498,
                       -0.8382154166978522, -0.14272030990811013, -0.15849819639360752, 0.15425476649857556, 1.2515451419349455]])

matrix30D = np.array([[-0.24415797617133117, -0.3629778598966794, -0.025771631863859217, 0.8229781816198142, -1.0016940502240026, 0.4296448224812279, 1.2473170610679825, -0.9378241839672766, 0.5806047982406501, 0.4115684796126129, 0.37378270762270127, 0.014477980320051913, 0.24111989003425846, 0.14208416160447723, 0.6431648703781747, -1.1960480734219814, -0.09541787405348977, -0.8826430338513224, 0.06157200009026991, 0.6518593178226029, 0.7356482715010267, -0.6524663204047787, -0.7148187616183787, -0.0856485125356522, 0.2175717453141174, -0.17759969600204073, 0.49023742257745073, -1.1831424839930096, -0.4984723253132853, 0.08744869210767466],
                      [0.0696863657945216, -0.5060813445994665, -0.02640078047539199, -0.4650825928424804, -0.011660254464842694, 0.30319144433961687, -0.01832001593989361, -0.1919892233594309, 0.2549400776258536, -0.1838723446922793, -0.2207368747600526, -0.1471054543307868, 0.3790018422866155, 0.030801483548504927, 0.32612886899231947,
                       0.26917928891695997, 0.030286949485795633, 0.6111944500481038, -0.23125092522758592, 0.756828249889362, 0.12289225796269292, -0.2085936114532866, -0.30575995026671166, -0.6076561993016952, 0.020547539028165016, -0.5948950904386973, -0.6989480504774146, 0.642317402028593, -0.658582668007117, -1.9310950228018156],
                      [0.6182210089859005, 0.08469883581782425, -0.715202750657864, -0.10689864320172354, 0.8815208048157552, -0.6723141944035139, 0.7025831889123358, -0.06336560769413899, -0.6505734238934142, -0.7964669005257073, -0.8748124658096694, -0.06356032275692644, -0.6081389795514863, 0.1349529532597709, 0.7214354566989988, -
                       0.2404961135873736, 0.3903573578567388, -0.14117460619677125, 0.03135977518895493, -0.3465466148174292, 0.7252225612181439, -0.4676549382078047, 0.8072019777726889, 0.10333733388275301, -0.12363244332318712, 0.3693626729122148, 0.30991477446959703, 0.6825302395308693, -0.2316375646385486, 0.851419827678896],
                      [-0.1422838783275414, -0.3257611522236677, 0.3234042190680949, -0.40373848491187536, -0.07012446435116082, -0.4265850351231416, -0.06950293016609707, 1.0906290705010628, 0.23524253461138142, -0.8654284266933125, 0.21280070313115437, 0.1491382594227291, -0.03776545746276128, -0.8863933276646458, 0.5951933305720567,
                       0.24912543166106357, -0.412791413712175, 0.3214314670028321, -0.8335840905602045, 0.08044128467646398, 0.6412983804127074, 0.4608569967948416, -0.01970430080415135, 0.41110938370644307, 0.09111542346756432, -0.021878890404958315, -0.33055924958789107, -0.2536892077543866, 0.5609010686904733, -0.5673424974952329],
                      [-0.09454067257351423, 0.3349336031145085, 0.12510790781408673, 0.33934822087672445, -0.4303393713754486, -0.8500612921392777, -0.025830986147262775, -0.40261099282305074, 1.3795092249145322, 0.5830275612023639, 1.1723017382685115, -0.016084363194653832, -0.0010036934128044225, -0.45743031433085934, -0.028457788133284423, -
                       0.04277097041381193, 0.6047959449548794, 1.0427550925924531, 0.08522772251130126, 1.026658128702627, -0.08823109167864493, 0.24176307315030804, -0.7529916756307705, 0.11613938699010794, -0.014876858620700373, -0.006399828109041203, -0.2019787407243364, -0.18088576354318964, 0.08089254517733155, -0.469265558941737],
                      [-0.02706813178554679, 0.010367219958836382, -0.25176931579503253, -0.25864110296971743, 0.02301718133034092, -0.43348529635746236, -0.006277106501408065, 0.13444457815819574, -0.5876226746740735, 1.1474269948293025, -0.17545466311197006, 0.473790154766074, 1.2007604078438672, -0.400960316564303, 0.3690009002692958, -
                       0.3916827657161646, 0.48466106801406295, 0.5984772531795615, -0.20795982758734022, -0.5481712905551321, 1.0893371609991616, 0.9654213308832109, -1.1198944283147472, -0.5474807206091883, -0.494708735356575, 0.16557749200590863, 0.2643722481563944, -0.15870046483433192, 0.2135013665235056, 0.7130167160764739],
                      [-0.1662241926079159, -1.2937837601970033, -0.7849925628404485, 0.02255721697866861, 0.6998250452627367, 0.7923992827929015, -0.411549379614634, 0.005090237399313233, -0.19341858683544877, -0.45537301700736194, 0.6471173330826264, -0.6088699292679896, 0.35127180530483265, 0.025735231672505632, -0.06672835810901795,
                       0.8314206052184767, 0.18348978146728573, -0.2998819553296103, 0.20082892415721063, -0.5066416177807921, 0.5207418925992354, -0.738665481897798, -0.5104686404804015, -0.703701006453205, -1.200344615546625, -0.8060702357234216, -0.61024035085568, 0.3889180943616861, 0.05119932449950286, 0.6030731095801309],
                      [0.4559605864787219, 0.06437070571039213, 0.0954508689021255, -1.172840718633678, 0.17030688937141256, 0.466203952601758, 0.1406663641948111, -0.5770107384930494, -0.5185141761187327, 0.3544363696063443, 0.8930812142930364, 0.6462453641177555, -0.5310094565243813, -0.17800308964589293, -0.13379282610831977, -
                       0.7528059077336271, -0.523235559882417, -0.47384741749215636, 0.44576835183928004, -0.3521099055382947, -1.2040114067658438, 0.30561033288239126, 0.4081217979936844, -0.02125373669832332, -0.2933905883878369, -0.04149665210875168, -0.008385243789877539, -0.2751327552923185, -0.1719910657294616, -0.3603111537158193],
                      [-1.2440209840194787, 0.18600960770413574, 1.5234473666150032, 0.6372164775914188, -0.7067872152820598, -0.09329682343981056, 0.07585319313081089, -0.27762936942960015, -0.27387269933041775, 0.4976916727982114, 0.5403836394843771, 0.14583962497295858, -0.4568172818788001, 0.040819854314474185, 0.35291684408409224,
                       0.09428835515473148, 0.3983850391736472, 0.4771255845270982, 0.25665398047825816, 0.44297030841999746, 0.379349438498325, -0.6483238267390634, -0.26597158107661395, -0.21937504315999423, 0.19820201974656781, 0.40810758258273117, 0.12344383052121652, 0.16004699151926552, -0.05003344532078717, 0.42265739101167593],
                      [0.5327905475470192, -0.7741849463651709, 0.26048305828149754, 0.6212894752480851, -0.2913208153869774, 0.845185856246884, -0.10573428432942601, -0.3004137020149608, -0.4536701213382787, 0.22962473845124998, -0.457878535088495, -0.9725776524066423, -1.026993523470228, -0.4136579543649682, -0.627761941014733, -
                       0.005544649381651433, 0.5058052147512437, 0.1347004478560244, 0.46560180304523746, 0.3450436361359998, -0.9143593219139656, 0.5127974649718243, -0.06607415948686027, -0.04345874251862052, 0.5390462832936525, 0.06026415360873097, 0.7679484648287777, -0.7379514651587145, 0.07561107374386902, -0.01562365117071193],
                      [0.4478297965226008, 0.0999372699709477, -0.5234063910810418, -0.872493322683741, -0.17719934572116405, 0.05782265577492497, -0.052638119993973706, 0.28218855249259145, -0.35388264534215946, 0.7627195192894962, 0.34422778396797515, -0.1915018321957579, 0.2268120165814829, 0.43229900056073445, 0.22214070583925408,
                       0.41833846519962187, 0.2056888889144615, -0.37209036973458254, 0.46906911895840403, 0.8129271057756465, 0.20073669151979084, 0.23659176560377926, 1.1261787683959885, 1.4602709066505466, -0.0913765673262805, -0.8348264212257537, -0.9021955852991717, 0.08628224684233214, -0.696961286196059, 0.023611597817413846],
                      [-0.5778564377478782, -0.6153264061834051, -0.8410162575408124, -0.9259924765522334, -0.4792657867150168, 0.21231911561910727, 0.40160655422791613, 0.13319937655222414, -0.04519478467524819, -0.05888734609940097, -0.7433985581376058, 0.18428925253474931, -0.9222513386443089, 0.01687410426574945, 0.6615177068742466,
                       0.2592292786482728, 0.38873811329265606, -0.43793222473801374, -0.2300815633299828, 0.16586790473874363, -0.5430030083555014, 0.8535491016961871, 0.09983163092450519, 0.320509586584195, 0.13648222161540094, 0.6179855743217844, -0.8657952698899307, 0.1262854667032729, 0.6196451981288785, -0.5756246829443674],
                      [0.1780090514368573, 0.6574734686427509, -0.5801947140711495, -0.7113338505590743, -0.4209520387912745, 0.25759585985235073, 0.022386498096828543, 0.6875259851288092, -0.43206066674191973, -0.758127913170196, -0.6208648485819169, 0.7908604597118424, -0.7011277750841167, 0.6153544401736631, -0.7033573990562646, -
                       0.3331012710105753, -0.19973395104155903, 0.36732247236949345, -0.8158990536790423, 0.07563657764321154, -0.14864927432559338, 0.4800229358933217, -0.32834323283387906, 0.4880931367066433, -0.046595345418194226, 0.31076297981222206, -0.11109418622486184, -0.704264617960512, 0.3458887455449835, -0.0011835147063002423],
                      [0.7788269169810891, 0.03379124395898091, -0.3887918326880264, -0.2772408139636585, -0.07656631597596125, -0.19631417493581454, -0.1740326702622334, -0.06961840922790455, 0.17141868920448045, -0.4377362641367542, -0.9560225923254281, -0.8292947219590668, 1.4125041074085158, -0.7650885589975412, -0.49523865569782155, -
                       0.18380684115102158, 1.1170161797395441, -1.298380594809119, -1.0035360505485005, 0.2483028595307139, 0.0781388253071057, -0.42973199404826823, -0.5362836690691362, 0.2756137073824725, -0.09883587540870221, -0.2081774291903833, -0.5464783617389075, 0.06781646805721118, 0.16110809625603603, 0.23336329088558727],
                      [-0.6435097293659593, -0.606502859133339, 0.04177825214010064, 0.21250431217774393, 0.5689115788681713, 0.03099418612443204, -0.3869478691586266, 0.12658210424927868, -0.11440768154296067, 0.8530207796244793, -0.5687189077909988, -0.13535436802249456, 0.3720052427841296, 0.35360604020162834, -0.24827547805902822, -
                       0.5769989931793598, 0.6682802147000084, -0.20797080431693934, 0.29357588352513614, 0.5054932944840316, -0.12740960649776967, -0.09942136234681635, 0.14278639744026145, 0.5806161476108449, 0.9328754175459328, -3.068204709107125e-05, 0.23751516869107858, 0.9032266296767456, -0.1888603565942328, 0.18883150858078682],
                      [0.5327651915724533, 0.11195771764132577, 0.1914076749842824, 0.5637726294423818, 0.7874770028352207, 0.4465234938374055, -0.2527589313564717, 0.7273644530371607, -0.15610547189212395, -0.09396708782256444, -0.10523121780701541, 0.21785417693363623, 0.4208338883501319, 0.44788139957492934, 1.0604521266570879,
                       1.4189801892530718, 0.4900696834276783, 0.5119411730390904, -0.12097198691340771, -0.07231393999358521, -0.36252072428382437, -0.2554817969260664, -0.28460459085668954, 0.49535873392421426, 0.27167118141506147, -0.22218683825173638, -0.26178475352298325, -0.22993556394813985, -0.3821433949677236, 0.23778269965655247],
                      [-0.7637447809131526, -0.44933701303800133, 0.31795139453301974, 0.5659841850677332, 0.15510223529664321, -0.547738949151706, 0.25622005577236345, 0.3712071531098663, 0.01324634420612504, -0.10212088736513447, -0.05810162962687612, 0.0904074585972174, 0.33777073318738343, 0.11816762945116313, 0.02761671369606078,
                       0.1292341058595661, 0.15820285689850766, 0.17729412156136612, -0.4353652355474657, 0.5947876043219285, 0.19891762637294358, 0.22722860406830364, 1.2601299736336238, -0.4163298561004527, -0.47272179469913467, 0.18402680878158123, -0.6939273599354413, -0.7261535952592272, 0.3563209223214253, 0.7190777882321077],
                      [0.027248949595568644, 0.15166546537934147, -0.4111693140488253, -0.20230784507415903, 0.15801529091832245, 0.1059294921252284, -0.11567588084304466, 0.6088528846905249, -0.3412131452444802, -0.15729499384376586, 0.7401055317297539, -1.5006289832915671, 0.13090767568871237, -0.37272686872380556, 0.6370798781282889, -
                       0.33667335330587517, 0.5508130036005932, -0.4176674376320644, -0.1442216731275609, -1.0288483850076697, -0.04725689571527415, 0.6061425281688448, -0.26582812921124604, -0.34010816358942053, 0.6740955997168462, -0.14153986785434847, -0.4746644753735187, 0.06934473290581603, 0.00014184921564734665, 0.4433300034159752],
                      [0.08419707796852648, -0.3314780915307308, -0.5748777413971959, 0.5582140861395108, -0.00771133694632169, -0.5624791612969371, -0.6393558368233327, -0.40183976093129536, -0.08292280339767255, 0.20319471472109374, 0.1627920682833453, -0.30801587220003646, -0.5770041704285909, -0.7735049322123501, 0.46182980542289415, -
                       0.5250504125375844, 0.33806078139556, -0.03377008172498841, 0.41281565364577233, 0.1673081250170544, 0.18663200040080657, -0.2619323744164921, 0.35228362288863574, -1.1778287360994388, 0.006762231985964498, -0.7460690295791756, -0.5899610518113729, -0.589398749856204, 0.5215467417902745, -0.4720957938921199],
                      [-0.931199005996854, 0.43277972981622004, -0.6788644747795615, -0.18769300919624224, 0.9225276939240815, -0.2492459271661735, 1.2561591206849212, 0.017013643162545916, 0.004329514934235869, 0.18705846081209077, -0.043203736666849755, 0.6081602203988467, -0.3117414351751388, -0.12080026150693676, -0.20085128126327123, -
                       0.3495641693767574, -0.2617431378699667, -1.0742483229978674, -0.31149570727587006, -0.2049854923084885, 0.412238149142494, -0.09172510483652617, -9.379873505933889e-05, 0.2851107181556532, 0.04338034859583835, -1.0063737694040293, 0.07775418686371369, -0.36254146913912216, -0.5520777213772112, -0.3733820589476754],
                      [0.04116705063387595, -0.24425211387516635, 0.868177624936142, -0.6310643735648179, 0.6965422027113577, 0.40319728431999535, -1.0508692395121153, -0.20790409002778718, 0.32719278565624244, 0.573022016022216, -0.1386032997236148, -0.01693461916220912, -0.4045826507260844, -0.09919495365883366, 0.4564017588058512,
                       0.8900608375745283, -0.6118728617372957, 0.13113611503760472, -1.1100834310585534, -0.3459208220777488, -0.30042198432214434, 0.18991392015661507, -0.12291308082799066, -0.16891773536567184, 0.09902588442792665, -0.1295197016468267, 0.7799472999406502, -0.2589849200518236, -0.2705059566437447, -0.041066080450706505],
                      [0.06364293256789, -0.029462535446426047, -0.43772044622958267, -0.3771028741371682, -0.19824965325213048, -0.26796733841199005, 0.14799726274422473, -0.5091895974909051, -0.8310202978017072, -0.2993304957719206, -0.3525293201505264, -0.47513281224425963, 0.2773403104635961, 0.005756957893099445, 0.7089630701153238, -
                       0.04874928997518104, 0.28860260664614024, 0.09587941102473566, -0.4337145058932092, -0.1576319633091992, -0.6596716147693944, -0.4045145460914585, 0.3059928841445649, -0.050113121531001566, 0.10969143426704225, 0.30054854913719564, 1.047377155881221, 0.2154051997932506, 0.05567285281411036, -0.673115503345183],
                      [-0.2446941577971199, 0.106801747558545, 0.5177811430675091, -0.7425229033260294, 0.08758867199750504, 0.1488061243987806, 0.16402967563046653, 0.5419463641830184, 0.7326939633320102, 0.027811516346864403, 0.011000864954076438, -0.32341278575120824, 0.2897436489179927, -0.12186786919688203, -0.6324240007689849, -
                       0.09420751707073916, -0.4826010926339242, 0.565034246460138, 0.44977967161758536, -0.5184709981086193, -0.04829432448780157, -0.0304127641931348, -0.1939220555449293, 0.1293952584865357, 1.0007001700968348, -0.644818117165531, -0.24188732014255082, -0.08002082361010655, 0.08083068399885046, 0.5675133480218297],
                      [-0.04064469007650939, -0.8053740565771232, 0.06269135922206256, -0.16980811851286837, -0.3231364263252641, 0.8015624492193028, 0.6080184848683853, -0.44126427156650444, 0.2524892845855758, 0.0827563726106704, 0.6239258604598814, 0.0832768086476268, 0.25416569089101493, -0.0869651286872917, 0.5578373622386232,
                       0.4751502036558199, 0.1535095715398947, -0.109541964830443, -0.35704762816262214, -1.0162460336743973, 1.1701009734426944, 0.053127030907076905, -0.1743631787913957, 0.23589406161222792, 1.4550702556977255, 0.17956079554205673, -0.18126194795380912, -0.35973459359790766, -0.42567330831406897, 0.1407599647811832],
                      [-0.4231030504583378, 1.3993791734006384, -0.2974867876655841, 0.15602781829287796, 0.29199620055090375, 0.6858788413037628, -0.16350822491602326, -0.3550392847780144, 0.33905640188520225, -0.21439719070100224, 0.3079795587172005, 0.5687468450030202, -0.005316770326502202, -0.7585241434126971, 0.4545479908160448,
                       0.7891296191404112, -0.2754348270399245, 0.254161382530106, -0.14951441180599565, 0.6424193617583918, -0.5081042102635959, 0.1780925717035237, 0.47903610264167507, -0.2953055281360557, 0.3634409958852889, 0.6295044167232462, 0.14806437233862593, 0.2591894360442388, -0.7264873881286057, 0.38278716069019314],
                      [0.3921856376731301, 0.3017296264325326, -0.08937841704803298, -0.33128521745664474, 0.7075639990998909, 0.6524794994457755, -0.3556210203445219, 0.3915628693526461, -0.4060738297958019, 0.2623372115106654, -0.6226757627498926, -0.686829509408306, -0.8802850053493994, 0.0891112829587712, -0.368448384696812,
                       0.40038493018851656, -0.5686153365648299, -0.7330852401360398, -0.8171702320310947, 0.4262549255179605, -0.054719377308353336, 0.3733440317259621, -0.0034952930501937624, 0.6310827664020321, 0.39341772826956545, 0.7843883618126585, -0.5528061449161896, -0.7256171706424286, 1.2888700744945383, 0.1619270450131655],
                      [0.2550723175369013, -0.28724568573356946, -0.006174842350617299, 0.012864444322135571, 0.24471340126827526, 0.45123251816548665, 0.3652990125826973, -0.5631916381032893, 0.3067845475760742, 0.29658312359131167, -0.22885718615661893, 0.3757514854834658, 0.7064767555106136, -0.5348913902315591, 0.2979528592573472,
                       0.4979861846667213, -0.1035696209638984, -0.7355431110717402, -1.1668152496168631, -0.15749648875652353, 0.5150036159505347, 0.3642258119005273, 0.027052424742704917, -0.2753461499806025, 0.2786051523968783, -0.6492345136837528, -0.05729164898573211, 0.7817979032165872, 0.3088327898252882, 0.767521393507543],
                      [-0.7203579536098543, 0.12186760463050267, 0.6993165883356993, 0.25470286360719924, 0.07156037889248763, 0.5083236268538709, -0.7738843723158384, -0.8706267296971979, -0.2997035074548644, -0.1646895384064018, 0.2318690664960127, -0.300834802890036, 0.14743182359894935, 0.3398984557528355, 0.16568236949094028,
                       0.053229818872275306, 0.48674262643751776, -0.2025190794921917, 0.6839931409948092, 0.8778118040515414, 0.012419916881345049, 0.585798656306177, -0.6983453607754033, 0.2625647706455376, -0.5724090617650777, -0.2929380226445725, -0.6314847989197571, -0.3433025839911423, 0.6251478033818892, -0.06194723002124032],
                      [0.48494634843398743, -1.0646641154737155, -0.3162425757708595, 0.6599352254560598, 0.27911403881285113, -0.6383838192620968, 0.10451100176490347, -0.6300073511955803, -0.07816628738603076, 0.17361435117137894, 0.5116148182745501, -0.1799805841887142, -0.34195261491435486, 0.1361304235158068, 0.6363577531380599,
                       0.46254787581617707, -0.39831779952313334, -0.5021469245000705, 0.07294492797704483, 0.5205235336992341, -0.10450885208855465, 0.052059739437135814, -0.2350561490106614, -0.2517601437397039, 0.29275707838129317, -0.4409220071562644, -0.41161368768391854, -0.38709462245053244, -0.6485935288927744, 0.2291863966962973],
                      [0.44300444268054223, -0.03421267135612949, -0.7968740372230199, -0.2948702246276172, 0.33819048231434223, -0.45248335923393934, 0.0002829197632219019, 0.4559788937173712, 0.1115694082096472, 0.01740552441265769, 0.5874992458516929, 0.2635337857730487, -0.09293931815122562, 0.5520651770187974, 0.39362461781370917,
                       0.7172616178908198, 1.2713997332235305, -0.7345751921321013, 0.9308900908704225, 0.7152942154835733, 0.04501525040916676, 0.18001372272860333, -0.5112250025957518, -0.6931834769358324, 0.007719485547783567, -0.022186014617412653, 0.5222714167490485, -0.491943461735535, 0.3329814936821886, -0.09154425206730374]])


def levy(d):
    dim = len(d)
    a = 0.0
    for i in range(dim - 1):
        a += pow((d[i] - 1) / 4.0, 2) * (1 + 10 *
                                         pow(sin(pi * ((d[i] - 1) / 4.0 + 1) + 1), 2))
    b = 1 + (d[0] - 1) / 4
    z = pow(sin(2 * pi * (1 + (d[dim - 1] - 1) / 4)), 2)
    c = pow(sin(pi * b), 2) + a + pow((d[dim - 1] - 1) / 4, 2) * (1 + 10 * z)
    return c


def sumsquare(d):
    s = 0
    for i in range(len(d)):
        s += (i + 1) * d[i]**2
    return s


def zakharov(d):
    dim = len(d)
    a = sum(d**2)
    b = 0
    for i in range(dim):
        b += 0.5 * (i + 1) * d[i]
    return b**2 + b**4 + a


def quadric(d):
    dim = len(d)
    s = 0
    for i in range(dim):
        s1 = 0
        for j in range(i + 1):
            s1 += d[j]
        s += s1**2
    return s


def wrapperFct(fct, dim=30):
    if not isinstance(dim, type(1)):
        raise TypeError("type error")

    @functools.wraps(fct)
    def func(x):
        x = np.array(x)
        if dim == 10:
            return fct(np.dot(x, matrix10D))
        if dim == 30:
            return fct(np.dot(x, matrix30D))
    return func

ackley = opr.ackley
sphere = cma.fcts.sphere
rosen = cma.fcts.rosen
griewank = cma.fcts.griewank
weierstrass = opr.WeierstrassFunction()
rastrigin = cma.fcts.rastrigin
schwefel = cma.fcts.schwefelelli

dim = 30
Rackley = wrapperFct(ackley, dim)
Rrosen = wrapperFct(rosen, dim)
Rrastrigin = wrapperFct(rastrigin, dim)
Rgriewank = wrapperFct(griewank, dim)
Rweierstrass = wrapperFct(weierstrass, dim)
Rlevy = wrapperFct(levy, dim)
Rschwefel = wrapperFct(schwefel, dim)

fgroup = [sphere, quadric, sumsquare, zakharov, rosen, ackley, griewank, weierstrass, rastrigin, levy,
          schwefel, Rrosen, Rackley, Rgriewank, Rweierstrass, Rrastrigin, Rlevy, Rschwefel]
up = [100, 100, 10, 10, 2.048, 32.768, 600, 0.5, 5.12,
      10, 500, 2.048, 32.768, 600, 0.5, 5.12, 10, 500]
if __name__ == '__main__':
    print(quadric([0] * dim))
